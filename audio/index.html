<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="gbk">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>audio</title>
    <style>
    .playing{background: red;}
    </style>
</head>
<body>
    <div class="play">123</div>
    <audio id="audio" src="//bpic.588ku.com/music/yinxiao/yinxiaomp3/e09c4919-e804-4252-93e1-c1d2c2909758.mp3" controls="controls" autoplay="autoplay" loop="loop"></audio>
    <script src="//cdn.bootcss.com/vConsole/3.2.0/vconsole.min.js"></script>
    <script src="//ossweb-img.qq.com/images/js/jquery/jquery-1.11.3.min.js"></script>
    <script>
    function audio(id,element,klass){
        // getAudio
        var music = document.getElementById(id)
        var touch = true;
        var curent = true;

        // listenerPlay
        music.addEventListener('playing', function () {
           $(element).addClass(klass)
           touch = false;
        }, false);

        // listenerPause
        music.addEventListener('pause', function () {
           $(element).removeClass(klass)
        }, false);

        // weixinPlay
        document.addEventListener("WeixinJSBridgeReady",function(){
            music.play();
        },false);

        // clickPlayPause
        $(element).bind('click',function(){
            if(music.paused){
                music.play()
            }else{
                music.pause();
            }
            curent = !curent;
        })

        // touchPlay
        document.addEventListener('touchstart', function(){
            if(touch){
                music.play();
            }
        }, false);

        // togglePlayPause
        document.addEventListener('visibilitychange', function() {
            if(document.hidden){
                music.pause();
            }else{
                if(curent){
                    music.play();
                }
            }
        })
    }
    audio('audio','.play','playing')
    </script>
</body>

</html>
